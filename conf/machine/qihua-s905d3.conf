# Qihua s905d3 board

require conf/machine/include/amlogic-s905d3.inc

KERNEL_IMAGETYPE = "uImage"
KERNEL_DEVICETREE = "amlogic/meson-sm1-qihua-s905d3.dtb amlogic/meson-sm1-sports-cle-v4.dtb"
#IMAGE_BOOT_FILES = "extlinux.conf;extlinux/extlinux.conf meson-sm1-sei610.dtb meson-sm1-khadas-vim3l.dtb meson-g12a-u200.dtb meson-g12a-x96-max.dtb"

PREFERRED_PROVIDER_amlogic-fip = "amlogic-fip-prebuilt"
PREFERRED_PROVIDER_virtual/bootloader = "u-boot-meson-gx"
PREFERRED_PROVIDER_u-boot = "u-boot-meson-gx"
PREFERRED_VERSION_u-boot-meson-gx = "2021.04%"
PREFERRED_VERSION_u-boot-tools = "2021.04%"

UBOOT_MACHINE = "odroid-c4_defconfig"
#UBOOT_EXTLINUX = "1"
#UBOOT_EXTLINUX_ROOT = "root=/dev/mmcblk0p2"
#UBOOT_EXTLINUX_FDT = "../meson-sm1-qihua-s905d3.dtb"
#UBOOT_EXTLINUX_CONSOLE = "console=ttyAML0"

MACHINE_ESSENTIAL_EXTRA_RDEPENDS += " \
       kernel-image \
       kernel-devicetree \
       u-boot-meson-gx \
       u-boot-tools \
"

MACHINE_EXTRA_RRECOMMENDS += "linux-firmware-rtl8821 kernel-module-8821cu rtl8821cu"
MACHINE_EXTRA_RRECOMMENDS += "linux-firmware-rtl8723 rtl8723du kernel-module-8723du"
MACHINE_EXTRA_RRECOMMENDS += "openocd python3-esptool"

#INITRAMFS_FSTYPES = "cpio.xz"
#INITRAMFS_IMAGE ?= "core-image-minimal"
INITRAMFS_IMAGE_BUNDLE = "1"

# Generate an SDCard Image
IMAGE_CLASSES += "image_types_meson"


WKS_FILE = "sdimage-meson.wks"
#WKS_FILE = "sdimage-bootpart-meson.wks"
